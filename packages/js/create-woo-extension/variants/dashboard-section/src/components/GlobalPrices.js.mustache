/**
 * External dependencies
 */
import moment from 'moment';
import { __ } from '@wordpress/i18n';

/**
 * WooCommerce dependencies
 */
import { Card, CardHeader, CardBody } from '@wordpress/components';
import { Chart } from '@woocommerce/components';
import Currency from '@woocommerce/currency';

const storeCurrency = Currency();
const data = [];

for ( let i = 1; i <= 20; i++ ) {
	const date = moment().subtract( i, 'days' );
	data.push( {
		date: date.format( 'YYYY-MM-DDT00:00:00' ),
		primary: {
			label: __( 'Global Apple Prices, last 20 days', '{{textdomain}}' ),
			labelDate: date.format( 'YYYY-MM-DD 00:00:00' ),
			value: Math.floor( Math.random() * 100 ),
		},
	} );
}

const GlobalPrices = () => {
	const average =
		data.reduce( ( total, item ) => total + item.primary.value, 0 ) /
		data.length;
	const legendTotals = { primary: average };
	return (
		<Card className="woocommerce-dashboard__chart-block woocommerce-analytics__card">
			<CardHeader>
				<h3>
					{__('Global Apple Prices', '{{textdomain}}')}
				</h3>
			</CardHeader>
			<CardBody>
				<Chart
					title={__(
						'Global Apple Prices',
						'{{textdomain}}'
					)}
					interval="day"
					data={[...data].reverse()}
					dateParser="%Y-%m-%dT%H:%M:%S"
					legendTotals={legendTotals}
					showHeaderControls={false}
					valueType={'currency'}
					tooltipValueFormat={storeCurrency.formatCurrency}
				/>
			</CardBody>
		</Card>
	);
};

export default GlobalPrices;
